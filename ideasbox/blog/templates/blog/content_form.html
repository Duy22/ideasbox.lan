{% extends 'base.html' %}
{% load i18n static ideasbox_tags %}

{% block extra_head %}
    <link rel="stylesheet" href="{% static 'ideasbox/vendor/minislate/minislate.min.css' %}" />
    <script src="{% static 'ideasbox/vendor/minislate/minislate.js' %}"></script>
    <script src="{% static 'ideasbox/js/forms.js' %}"></script>
{% endblock extra_head %}

{% block content %}
    <form method="POST" enctype="multipart/form-data" id="model_form">
        <div class="row">
            {% if content %}
                <h2>{% fa 'pencil' %} {% trans "Edit post" %} "{{ content }}"</h2>
            {% else %}
                <h2>{% trans "New post" %}</h2>
            {% endif %}
        </div>
        <div class="row">
                <div class="col third">
                    {% csrf_token %}
                    <h3>{% trans 'Metadatas' %}</h3>
                    {% for field in form %}
                        {% form_field field %}
                    {% endfor %}
                    <input type="submit" value="{% trans 'submit' %}" />
                </div>
                <div class="col two-third">
                    <h3>{% trans 'Content' %}</h3>
                    <div id="editable-content" placeholder="{% trans 'Type your text hereâ€¦' %}">{{ content.text|safe }}</div>
                </div>
        </div>
    </form>
{% endblock content %}
{% block extra_foot %}
    <script type="text/javascript">
        var textarea = document.querySelector('textarea[name="text"]');
        var label = document.querySelector('label[for="text"]');
        var form = document.querySelector('form#model_form');
        var element = document.querySelector('#editable-content');
        textarea.style.display = 'none';
        label.style.display = 'none';
        var editor = new IDB.editor(element);
        form.onsubmit = function () {
            textarea.innerHTML = element.innerHTML;
        };
    </script>
{% endblock extra_foot %}
